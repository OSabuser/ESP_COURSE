# Таймеры ESP32

## Формулы для расчёта

- Разрешение таймера $T_{res}[\frac{сек}{бит}]$ - выражает величину количества времени, необходимого для увеличения счётчика таймера на 1.

### Время переполнения таймера

$T_{timeout} = (2^n - 1) * T_{res},  \text{n - разрядность таймера}$

$T_{timeout} = count * T_{res},  T\in[0, 2^n - 1], \text{для произвольного значения count}$

## ESP32-C3 таймеры

| Таймер | Назначение |
|---|---|
| System timer | генерация системных тиков для `RTOS`, периодические и one-time прерывания|
| General purpose timers | таймер общего назначения |
| Watchdog timers | аппаратные таймеры для обнаружения и восстановления после сбоев |
| RTC timer | используется в `Low Power Mode` |
| XTAL32K Wathcdog timer | используется для мониторинга статуса `XTAL32K_CLK` |

### General purpose timers

Тактовая частота берется от `APB_CLK` или `XTAL_CLK`.  
Являются частью `Timer group peripheral (TIMG)`:

![TIMG ESP32-C3](timg.png)

Каждая группа `TIMG` содержит инстанс `GPT` и `WDT` таймеров. Каждый `GPT` состоит из `16` битного предделителя и `54` битного счётчика.  
Таймера может считать как от 0 до значения таймаута, так и обратно (`upcounting` & `downcounting`). Таймер поддерживает auto-reload & alarm features.  

#### Alarm feature

> Похожа на Output compare: когда происходит совпадение с `ALARM_VALUE` значением, таймер генерирует прерывание и продолжает считать до значения таймаута.  
